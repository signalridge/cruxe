# CodeCompass Default Configuration

[index]
# Maximum file size to index (bytes)
max_file_size = 1_048_576  # 1MB
# Default result limit
default_limit = 10
# Languages to enable for symbol extraction
languages = ["rust", "typescript", "python", "go"]

[storage]
# Base data directory (~ expands to home)
data_dir = "~/.codecompass"
# SQLite busy timeout (ms)
busy_timeout_ms = 5000
# SQLite cache size (negative = KB)
cache_size = -64000  # 64MB

[search]
# Default ref for search queries
default_ref = "main"
# Default freshness policy: "strict", "balanced", "best_effort"
freshness_policy = "balanced"
# Ranking explainability payload level: "off", "basic", "full"
ranking_explain_level = "off"
# Hard payload safety budget for query tool responses (bytes)
max_response_bytes = 65536

[search.intent]
# Intent strategy rule order. Supported values:
# "error_pattern", "path", "quoted_error", "symbol", "natural_language"
# Env override: CODECOMPASS_SEARCH_INTENT_RULE_ORDER (CSV)
rule_order = ["error_pattern", "path", "quoted_error", "symbol", "natural_language"]
# Substring patterns matched for Error intent.
# Env override: CODECOMPASS_SEARCH_INTENT_ERROR_PATTERNS (CSV)
error_patterns = ["error:", "Error:", "panic:", "FATAL", "exception", "Exception", "traceback", "at line", "thread '"]
# File suffixes treated as path-like (case-insensitive).
# Env override: CODECOMPASS_SEARCH_INTENT_PATH_EXTENSIONS (CSV)
path_extensions = [".rs", ".ts", ".tsx", ".js", ".jsx", ".py", ".go", ".java", ".c", ".h", ".cpp", ".rb", ".swift"]
# Two-word symbol query prefixes, e.g. "fn validate_token".
# Env override: CODECOMPASS_SEARCH_INTENT_SYMBOL_KIND_KEYWORDS (CSV)
symbol_kind_keywords = ["fn", "func", "function", "struct", "class", "enum", "trait", "interface", "type", "const", "method"]
# Whether wrapped quotes like "connection refused" / `panic text` imply Error intent.
# Env override: CODECOMPASS_SEARCH_INTENT_ENABLE_WRAPPED_QUOTED_ERROR_LITERAL (bool)
enable_wrapped_quoted_error_literal = true

[search.semantic]
# Semantic mode:
# - off: lexical-only
# - rerank_only: lexical + optional rerank providers, no vector branch
# - hybrid: lexical + vector hybrid path (future extension)
mode = "off"
# Max semantic contribution cap (runtime can reduce this, including to 0.0)
ratio = 0.3
# Skip semantic branch when lexical confidence is already high
lexical_short_circuit_threshold = 0.85
# Low-confidence decision threshold for search metadata
confidence_threshold = 0.5
# Profile advisor mode: "off" | "suggest"
profile_advisor_mode = "off"
# Outbound-provider safety gates (secure by default)
external_provider_enabled = false
allow_code_payload_to_external = false

[search.semantic.embedding]
# Embedding profile: "fast_local" | "code_quality" | "high_quality" | "external"
profile = "fast_local"
# Embedding provider: "local" | "voyage" | "openai"
provider = "local"
model = "NomicEmbedTextV15Q"
model_version = "fastembed-1"
dimensions = 768
batch_size = 32
# Vector storage backend: "sqlite" (brute-force, <50k vectors) | "lancedb" (ANN, requires feature flag)
vector_backend = "sqlite"

[search.semantic.rerank]
# Rerank provider: "none" | "cohere" | "voyage"
provider = "none"
timeout_ms = 5000

[search.semantic.overrides.natural_language]
ratio = 0.5

[search.semantic.overrides.symbol]
ratio = 0.0

[search.semantic.overrides.path]
ratio = 0.0

[search.semantic.overrides.error]
ratio = 0.0

[logging]
# Default log level: error, warn, info, debug, trace
level = "info"

[debug]
# Legacy compatibility only. Prefer [search].ranking_explain_level.
ranking_reasons = false
